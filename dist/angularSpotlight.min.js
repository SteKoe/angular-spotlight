!function(t){t.fn.autoGrowInput=function(e){return e=t.extend({maxWidth:1e3,minWidth:0,comfortZone:70},e),this.filter("input:text").each(function(){var n=e.minWidth||t(this).width(),s="",r=t(this),i=t("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:r.css("fontSize"),fontFamily:r.css("fontFamily"),fontWeight:r.css("fontWeight"),letterSpacing:r.css("letterSpacing"),whiteSpace:"nowrap"}),l=function(){if(s!==(s=r.val())){var t=s.replace(/&/g,"&amp;").replace(/\s/g,"&nbsp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");i.html(t);var l=i.width(),o=l+e.comfortZone>=n?l+e.comfortZone:n,c=r.width(),a=c>o&&o>=n||o>n&&o<e.maxWidth;a&&r.width(o)}};i.insertAfter(r),t(this).bind("keyup keydown blur update",l),l()}),this}}(jQuery),angular.module("de.stekoe.angular.spotlight",[]).directive("spotlightOverlay",["$timeout","$http","$compile","AngularSpotlight",function(t,e,n,s){const r=40,i=38,l=32,o=27;var c,a,u;return{restrict:"E",controller:["$scope",function(e){function n(){c.find(".ng-spotlight-input").autoGrowInput({maxWidth:400,minWidth:10,comfortZone:15})}function r(t,n){var s=c.find(".ng-spotlight-results-list"),r=s.find("li.ng-spotlight-results-list-item"),o=$(r.get(t)),a=o.closest(".ng-spotlight-results-category").find(".ng-spotlight-results-list-header").text();r.removeClass("active"),o.addClass("active"),e.selectedItem=l(t),i(a),n&&e.$apply()}function i(t){e.searchInputInfo=void 0,0===e.searchTerm.length?e.searchInputInfo=void 0:e.selectedItem?e.searchInputInfo=e.selectedItem.name+" - "+t:0===e.searchResultCount()&&(e.searchInputInfo="Keine Ergebnisse")}function l(t){var n=Object.keys(e.searchResults).map(function(t){return e.searchResults[t].items}).reduce(function(t,e){return t.concat(e)},[]);return n[t]}function o(){var t=c.find(".ng-spotlight-results-list"),e=t.find("li.ng-spotlight-results-list-item"),n=-1;return e.each(function(t,e){return $(e).hasClass("active")?(n=t,!1):void 0}),n}e.searchResultsCount=0,e.searchResults=[],e.selectedItem=void 0,e.searchInputInfo=void 0,e.search=function(){s.search(e.searchTerm).then(function(s){n(),e.selectedItem=void 0,e.searchResults=s,e.searchResultsCount=Object.keys(e.searchResults).map(function(t){return e.searchResults[t].items.length}).reduce(function(t,e){return t+e},0),t(function(){e.selectedItem||r(0,!1)},20)})},e.getIconForType=function(t){return s.getIconForType(t)},e.showResultItem=function(t,n){var s=$(t.currentTarget),r=s.closest(".ng-spotlight-results-category").find(".ng-spotlight-results-list-header").text();s.closest(".ng-spotlight-results-list").find(".ng-spotlight-results-list-item").removeClass("active"),s.addClass("active"),e.selectedItem=n,i(r)},e.selectPreviousEntry=function(){var t=o();t-1>=0&&r(t-1,!0)},e.selectNextEntry=function(){var t=o();t+1<e.searchResultsCount&&r(t+1,!0)},e.resetSearch=function(){c.find(".ng-spotlight-input").val(""),e.searchResultsCount=0,e.searchResults=[],e.selectedItem=void 0,e.searchInputInfo=void 0,e.searchTerm="",e.$apply(),c.find(".ng-spotlight-input").width(400)},e.searchResultCount=function(){return Object.keys(e.searchResults).length}}],link:function(t,e){var n=$(e).children();c=$(e),a=c.find(".ng-spotlight-results-detail"),u=c.find(".ng-spotlight-results-panel"),$(document).click(function(t){console.log(),0===$(t.target).closest(".ng-spotlight").length&&n.hide()}),$(document).keydown(function(e){e.ctrlKey&&e.keyCode===l&&(e.preventDefault(),n.toggle(),n.is(":visible")&&(n.find("input").focus().val(""),t.searchResults=[])),e.keyCode===o&&(e.preventDefault(),t.resetSearch()),e.keyCode===i&&(e.preventDefault(),t.selectPreviousEntry()),e.keyCode===r&&(e.preventDefault(),t.selectNextEntry())})},templateUrl:"angularSpotlightTemplate.html"}}]).directive("spotlightResultIcon",["$compile","AngularSpotlight",function(t,e){var n={url:'<img class="ng-spotlight-item-icon" ng-src="{{iconDescriptor.data}}">',css:'<div class="ng-spotlight-item-icon" ng-class="iconDescriptor.data"></div>'};return{restrict:"E",scope:{selectedItem:"="},link:function(s,r,i){function l(e){var i=n[e.type];r.html(i).show(),t(r.contents())(s),s.iconDescriptor=e}i.type?l(e.getIconDescriptorForType(i.type)):s.$watch("selectedItem",function(){s.selectedItem?l(e.getIconDescriptorForType(s.selectedItem.type)):r.html("")})}}}]).directive("spotlightDetails",["$compile","AngularSpotlight",function(t,e){return{restrict:"E",link:function(n,s){n.$watch("selectedItem",function(){n.selectedItem&&(s.html(e.getTemplateForType(n.selectedItem.type)).show(),t(s.contents())(n))})}}}]).provider("AngularSpotlight",function(){function t(){function t(t){Object.keys(t).forEach(function(e){n[e]=t[e]})}function e(t){function e(t){var t=t.toLowerCase();return 0===t.indexOf("http")||0===t.indexOf("data:")?"url":"css"}var s=n[t]||n["default"];return{data:s,type:e(s)}}var n={"default":"fa fa-file"};return{addIcons:t,getIconForType:e}}function e(){function t(t){Object.keys(t).forEach(function(e){n[e]=t[e]})}function e(t){return n[t]||n["default"]}var n={"default":'<div class="ng-spotlight-results-detail-default">{{selectedItem.name}}</div>'};return{addTemplates:t,getTemplateForType:e}}var n=t(),s=e();this.search=function(){throw"You have to implement a search function using AngularSpotlightProvider!"},this.addIcons=n.addIcons,this.addTemplates=s.addTemplates,this.$get=["$http",function(t){var e=this;return{search:e.search(t),getIconDescriptorForType:n.getIconForType,getTemplateForType:s.getTemplateForType}}]}),angular.module("de.stekoe.angular.spotlight").run(["$templateCache",function(t){t.put("angularSpotlightTemplate.html",'<div class="ng-spotlight ng-spotlight-overlay">\r\n    <div class="ng-spotlight-searchbar">\r\n        <div class="ng-spotlight-icon">\r\n            <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"  viewBox="0 0 283.753 284.51" enable-background="new 0 0 283.753 284.51" xml:space="preserve">\r\n            <path d="M281.394,264.378l0.135-0.135L176.24,158.954c30.127-38.643,27.45-94.566-8.09-130.104\r\n	c-38.467-38.467-100.833-38.467-139.3,0c-38.467,38.467-38.466,100.833,0,139.299c35.279,35.279,90.644,38.179,129.254,8.748\r\n	l103.859,103.859c0.01,0.01,0.021,0.021,0.03,0.03l1.495,1.495l0.134-0.134c2.083,1.481,4.624,2.36,7.375,2.36\r\n	c7.045,0,12.756-5.711,12.756-12.756C283.753,269.002,282.875,266.462,281.394,264.378z M47.388,149.612\r\n	c-28.228-28.229-28.229-73.996,0-102.225c28.228-28.229,73.996-28.228,102.225,0.001c28.229,28.229,28.229,73.995,0,102.224\r\n	C121.385,177.841,75.617,177.841,47.388,149.612z"/>\r\n            </svg>\r\n        </div>\r\n        <input class="ng-spotlight-input" type="text" placeholder="Spotlight-Suche" ng-model="searchTerm" ng-change="search()"/>\r\n\r\n        <div class="ng-spotlight-input-after" ng-if="searchInputInfo && searchInputInfo.length > 0">&mdash; {{searchInputInfo}}</div>\r\n        <div class="ng-spotlight-results-icon">\r\n            <spotlight-result-icon selected-item="selectedItem"></spotlight-result-icon>\r\n        </div>\r\n    </div>\r\n    <div class="ng-spotlight-results-panel" ng-if="searchTerm && searchTerm.length > 0 && searchResultCount() > 0">\r\n        <div class="ng-spotlight-results-list">\r\n            <ul>\r\n                <li class="ng-spotlight-results-category" ng-repeat="searchResult in searchResults" ng-init="catIndex=$index">\r\n                    <div class="ng-spotlight-results-list-header">{{searchResult.name}}</div>\r\n                    <ul>\r\n                        <li class="ng-spotlight-results-list-item"\r\n                            ng-class="{\'active\': selectedItem.name == resultItem.name}"\r\n                            ng-repeat="resultItem in searchResult.items"\r\n                            ng-click="showResultItem($event, resultItem)">\r\n                            <spotlight-result-icon type="{{resultItem.type || \'default\'}}"></spotlight-result-icon>\r\n                            {{resultItem.name}}\r\n                            <span class="info" ng-if="resultItem.info">\r\n                                &ndash; {{resultItem.info}}\r\n                            </span>\r\n                        </li>\r\n                    </ul>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n        <div class="ng-spotlight-results-detail">\r\n            <spotlight-details></spotlight-details>\r\n        </div>\r\n    </div>\r\n</div>')}]);